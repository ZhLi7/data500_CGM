"0",""
"0","# Coerce different encodings to logical"
"0","to_logical <- function(x) {"
"0","  if (is.logical(x)) return(x)"
"0","  if (is.numeric(x)) return(x == 1)"
"0","  if (is.character(x)) return(tolower(trimws(x)) %in% c(""true"",""t"",""1"",""yes"",""y""))"
"0","  suppressWarnings(as.logical(x))"
"0","}"
"0",""
"0","# Choose availability columns by name pattern"
"0","avail_cols <- participants |>"
"0","  dplyr::select(dplyr::matches(""^(cardiac_ecg|clinical_data|environment|retinal_|wearable)""))"
"0",""
"0","# Fallback: any likely logical columns"
"0","if (ncol(avail_cols) == 0) {"
"0","  avail_cols <- participants |>"
"0","    dplyr::select(where(~ is.logical(.x) || is.numeric(.x) || is.character(.x)))"
"0","}"
"0",""
"0","# Summarize"
"0","avail_summary <- avail_cols |>"
"0","  dplyr::mutate(dplyr::across(dplyr::everything(), to_logical)) |>"
"0","  dplyr::summarise(dplyr::across(dplyr::everything(), ~ sum(.x %in% TRUE, na.rm = TRUE))) |>"
"0","  tidyr::pivot_longer(dplyr::everything(), names_to = ""modality"", values_to = ""n_available"") |>"
"0","  dplyr::mutate("
"0","    n_total = nrow(participants),"
"0","    prop_available = n_available / n_total,"
"0","    modality_pretty = modality |> stringr::str_replace_all(""_"", "" "") |> stringr::str_to_title()"
"0","  ) |>"
"0","  dplyr::arrange(dplyr::desc(prop_available))"
"0",""
"0","# Show table"
"0","knitr::kable("
"0","  avail_summary |>"
"0","    dplyr::select(modality = modality_pretty, n_available, n_total, prop_available) |>"
"0","    dplyr::mutate(prop_available = scales::percent(prop_available, accuracy = 0.1)),"
"0","  caption = ""Availability of each modality among participants."","
"0","  align = ""lrrr"","
"0","  digits = 3"
"0",") |>"
"0","  kableExtra::kable_styling(full_width = FALSE)"
